import { GoogleGenerativeAI } from "@google/generative-ai";

  const apiKey = "AIzaSyC1pISgpyxnj6qoWJS_UIKE-GBly55li8c";
  const genAI = new GoogleGenerativeAI(apiKey);
  

  const model = genAI.getGenerativeModel({
    model: "gemini-2.0-flash",
  });
  
  console.log("API Key:", apiKey);
  const generationConfig = {
    temperature: 1,
    topP: 0.95,
    topK: 40,
    maxOutputTokens: 8192,
    responseMimeType: "application/json",
  };
  
  
  export  const chatSession = model.startChat({
      generationConfig,
      history: [
        {
          role: "user",
          parts: [
            {text: "generate travel plan for location:new delhi , india . for 3 days for couple with a cheap budget . give me hotels options list , address , price , hotel images url , geo cordinates , rating , description , and suggest itineary with placeName , placeDetails , place image url , geocordinates , ticket pricising rating , time t travel each location for 3 days with each day plan with best to visit in JSON format"},
          ],
        },
        {
          role: "model",
          parts: [
            {text: "Here's a breakdown of the thought process to generate the Delhi travel plan:\n\n1.  *Understand the Core Request:* The user wants a 3-day travel plan for a couple visiting New Delhi, India, on a cheap budget. Key requirements include:\n    *   *Location:* New Delhi, India.\n    *   *Duration:* 3 days.\n    *   *Target Audience:* Couple.\n    *   *Budget:* Cheap/Budget-friendly.\n    *   *Outputs:\n        *   Hotel options (list, address, price range, image URL, geo-coordinates, rating, description).\n        *   Detailed 3-day itinerary (place name, details, image URL, geo-coordinates, ticket pricing rating, time to travel, daily plan).\n        *   **Format:* JSON.\n\n2.  *Deconstruct the Request into Manageable Parts:\n\n    *   **Hotel Selection:\n        *   *Constraint: Cheap budget. This means focusing on budget hotels, guesthouses, or hostels known for affordability in Delhi. Areas like Paharganj, Karol Bagh, and parts of South Delhi (near metro stations) are good candidates.\n        *   Data Points Needed: Name, Address, Price (estimate/range), Image URL, Geo-coordinates (Lat/Lon), Rating (e.g., out of 5 or 10), Description (brief).\n        *   Process: Search for \"budget hotels Delhi,\" \"cheap guesthouses Paharganj,\" \"affordable stays Karol Bagh.\" Look at popular booking sites (Booking.com, Agoda, MakeMyTrip, Goibibo) but be cautious about real-time prices – state them as estimates or ranges. Find representative images (use generic ones if specific hotel images are hard to get reliably without APIs). Get approximate coordinates using Google Maps. Provide a brief description highlighting budget aspects. Aim for 3-4 diverse options.\n\n    *   *Itinerary Planning:\n        *   *Constraint: 3 days, couple, cheap budget.\n        *   Goal: Cover major Delhi highlights while being mindful of cost and travel time between locations. Group attractions geographically to minimize travel. Balance historical sites, cultural experiences, and some local flavour.\n        *   Cost Consideration: Prioritize free or low-cost attractions (parks, temples, some historical sites have nominal fees). Indicate ticket price rating (e.g., Free, Low, Medium) rather than exact prices which fluctuate. Suggest using the Metro as the primary (and cheapest) mode of transport.\n        *   Couple Focus: Include some potentially romantic or atmospheric spots (Lodhi Garden, Hauz Khas Village - though parts can be pricey, walking around is free).\n        *   Structure: Day 1, Day 2, Day 3. Within each day, list places sequentially with estimated time allocation (including travel).\n        *   Data Points Needed: placeName, placeDetails (brief description), placeImageUrl (representative image), geoCoordinates (Lat/Lon), ticketPricingRating (Free, Low, Medium, High), timeToTravel (estimated time at the location + travel from previous).\n\n    *   *JSON Formatting:\n        *   *Structure: Create a main JSON object. Inside, have keys like tripDetails (location, duration, budgetType, targetAudience), hotelOptions (an array of hotel objects), and dailyItinerary (an array of day objects, each containing a day number and a placesToVisit array).\n        *   Data Types: Use strings for names, addresses, descriptions, URLs, price ranges, ratings, ticket ratings. Use numbers for day numbers. Use objects for geo-coordinates (latitude, longitude). Use arrays for lists (hotels, daily plans, places within a day).\n        *   Consistency: Ensure keys and structures are consistent across similar items (e.g., all hotel objects have the same keys, all place objects have the same keys).\n\n3.  *Drafting - Step-by-Step:\n\n    *   **Hotels:\n        *   *Paharganj: Known for budget stays. Pick a representative option like \"Hotel Shelton\" or a generic \"Budget Guesthouse Paharganj.\" Find address, estimate price (e.g., ₹800-₹1500), find a generic image of a budget hotel room/exterior, get coordinates from Google Maps, give a realistic rating (e.g., 3.0-3.5), describe it as basic/budget-friendly near the station.\n        *   Karol Bagh: Another budget/mid-range hub. Choose a hotel name or generic type. Repeat the data gathering process (Price maybe slightly higher ₹1200-₹2000).\n        *   South Delhi (Hostel): Include a hostel option like Zostel or Madpackers for the very budget-conscious or social couple. Hostels often have good ratings (e.g., 4.0+). Price per bed might be ₹500-₹1000.\n        *   Guesthouse: Add a generic \"Comfortable Guesthouse\" option perhaps in a slightly quieter area accessible by metro.\n\n    *   *Itinerary - Day 1 (Old Delhi Focus):\n        *   *Morning: Start with Jama Masjid (Free entry, photo fee maybe). Add details, image, coordinates. Allocate ~1.5 hrs.\n        *   Late Morning: Explore Chandni Chowk (Rickshaw ride optional - mention cost). Focus on the experience. Free to walk. Add details, image, coordinates. Allocate ~2 hrs.\n        *   Lunch: Suggest street food in Chandni Chowk (Budget-friendly).\n        *   Afternoon: Red Fort (Exterior view can be free/cheap, entry has a fee - Medium). Add details, image, coordinates. Allocate ~2 hrs (if going inside).\n        *   Late Afternoon: Raj Ghat (Gandhi Memorial - Free). Add details, image, coordinates. Allocate ~1 hr.\n        *   Travel: Mention using Metro (Yellow/Violet lines) and auto-rickshaws.\n\n    *   *Itinerary - Day 2 (New Delhi & Culture):\n        *   *Morning: Humayun's Tomb (Entry fee - Medium). Add details, image, coordinates. Allocate ~2 hrs.\n        *   Late Morning: Lodhi Garden (Free). Romantic, good for couples. Add details, image, coordinates. Allocate ~1.5-2 hrs.\n        *   Lunch: Suggest Khan Market (can be pricey) or cheaper options nearby/packed lunch.\n        *   Afternoon: India Gate & Rajpath (Free). Walk around. Add details, image, coordinates. Allocate ~1.5 hrs.\n        *   Late Afternoon: Visit a museum like National Museum (Entry fee - Low/Medium) or Crafts Museum (Entry fee - Low). Give options. Add details, image, coordinates. Allocate ~2 hrs.\n        *   Evening (Optional): Connaught Place (Window shopping/budget dinner). Free to walk around.\n\n    *   *Itinerary - Day 3 (South Delhi & Modern Touches):\n        *   *Morning: Qutub Minar (Entry fee - Medium). Add details, image, coordinates. Allocate ~2 hrs.\n        *   Late Morning: Lotus Temple (Bahá'í House of Worship - Free). Add details, image, coordinates. Allocate ~1.5 hrs.\n        *   Lunch: Suggest Nehru Place (budget options) or near Kalkaji Metro.\n        *   Afternoon: Hauz Khas Village (Walk around lake/deer park - Free; Boutiques/Cafes can be pricey). Good atmosphere. Add details, image, coordinates. Allocate ~2-3 hrs.\n        *   Alternative/Optional: Dilli Haat (Entry fee - Low; good for crafts and food, diverse state stalls).\n\n    *   *Refine Timings & Travel:* Add estimated travel times between locations (e.g., \"Metro + Auto: ~30-45 mins\"). Adjust time spent at each location to fit realistically within a day (approx 8-9 hours of sightseeing). Emphasize using the Delhi Metro.\n\n    *   *Budget Notes:* Add explicit tips: Use Metro, eat street food/at local dhabas, look for free attractions, bargain respectfully (where appropriate, like auto-rickshaws without meters or some market shopping).\n\n    *   *JSON Assembly:* Structure all the collected data into the defined JSON format. Double-check syntax (commas, brackets, braces, quotes). Use placeholders like \"[Image URL Placeholder]\" if actual URLs are hard to guarantee stability for. Use price ranges (e.g., \"₹800 - ₹1500\") instead of exact prices. Use price ratings for tickets (Free, Low, Medium, High).\n\n4.  *Review and Edit:*\n    *   Read through the JSON output. Is it valid? (Use a JSON validator if unsure).\n    *   Does it meet all the user's requirements? (3 days, couple, cheap budget, all specified data points).\n    *   Is the itinerary logical and feasible within the timeframe?\n    *   Are the budget considerations clear?\n    *   Are the descriptions helpful?\n    *   Are coordinates roughly correct? (Check a few on Google Maps).\n    *   Add disclaimers about prices and timings being estimates. Add safety/general travel tips for Delhi.\n\nThis systematic approach ensures all constraints are addressed, the required data points are included, and the final output is well-structured and useful for the user."},
            {text: "```json\n{\n  \"tripDetails\": {\n    \"location\": \"New Delhi, India\",\n    \"duration\": \"3 Days\",\n    \"targetAudience\": \"Couple\",\n    \"budgetType\": \"Cheap / Budget-Friendly\",\n    \"notes\": \"This plan focuses on maximizing experiences while minimizing costs. Prices are estimates and subject to change. It heavily relies on using the Delhi Metro and auto-rickshaws/e-rickshaws for transport. Consider purchasing a Delhi Metro Tourist Card for convenience.\"\n  },\n  \"hotelOptions\": [\n    {\n      \"name\": \"Hotel Shelton\",\n      \"address\": \"5043, Main Bazar Rd, near R.K Ashram Metro station, Aram Bagh, Paharganj, New Delhi, Delhi 110055\",\n      \"price\": \"₹1000 - ₹2000 per night (Estimate)\",\n      \"imageUrl\": \"https://pix8.agoda.net/hotelImages/286/286867/286867_17090617130056217067.jpg?ca=6&ce=1&s=1024x\",\n      \"geoCoordinates\": {\n        \"latitude\": 28.6428,\n        \"longitude\": 77.2136\n      },\n      \"rating\": \"3.5/5 (Approx)\",\n      \"description\": \"Located in the bustling Paharganj area, known for budget accommodations. Close to New Delhi Railway Station and RK Ashram Marg Metro Station. Basic amenities, suitable for budget travelers.\"\n    },\n    {\n      \"name\": \"Joey's Hostel\",\n      \"address\": \"1/49, Lalita Park, Main Vikas Marg, Opposite Metro Pillar No. 29, Laxmi Nagar, New Delhi, Delhi 110092\",\n      \"price\": \"₹500 - ₹1500 per night (Dorm bed / Private room estimate)\",\n      \"imageUrl\": \"https://cf.bstatic.com/xdata/images/hotel/max1024x768/160826177.jpg?k=1c4d93c6579874d28e10b6940f87a8f12ed2c1894811d80521a028ab05ae73c8&o=&hp=1\",\n      \"geoCoordinates\": {\n        \"latitude\": 28.6372,\n        \"longitude\": 77.2761\n      },\n      \"rating\": \"4.5/5 (Approx)\",\n      \"description\": \"Highly-rated hostel known for its clean environment and social atmosphere. Offers both dorm beds and private rooms. Located near Laxmi Nagar Metro Station (Blue Line), providing good connectivity.\"\n    },\n    {\n      \"name\": \"Hotel Singh Empire Dx\",\n      \"address\": \"8707-10, D.B. Gupta Road, opp. Shiela Cinema, Paharganj, New Delhi, Delhi 110055\",\n      \"price\": \"₹1200 - ₹2500 per night (Estimate)\",\n      \"imageUrl\": \"https://cf.bstatic.com/xdata/images/hotel/max1024x768/34985638.jpg?k=61a39e2030722c336a85b1b336798f09b7efae4d7a0b694200fa484fbbce593b&o=&hp=1\",\n      \"geoCoordinates\": {\n        \"latitude\": 28.6470,\n        \"longitude\": 77.2145\n      },\n      \"rating\": \"3.8/5 (Approx)\",\n      \"description\": \"A slightly better-equipped option in Paharganj, offering more comfortable rooms compared to basic guesthouses. Still budget-friendly and well-located for transport.\"\n    },\n    {\n      \"name\": \"Bloomrooms @ Janpath\",\n      \"address\": \"1, Janpath Ln, Janpath, Connaught Place, New Delhi, Delhi 110001\",\n      \"price\": \"₹2500 - ₹4000 per night (Estimate - Higher end of budget, check deals)\",\n      \"imageUrl\": \"https://imgcy.trivago.com/c_limit,d_dummy.jpeg,f_auto,h_1300,q_auto,w_2000/itemimages/31/85/3185906_v4.jpeg\",\n      \"geoCoordinates\": {\n        \"latitude\": 28.6254,\n        \"longitude\": 77.2196\n      },\n      \"rating\": \"4.2/5 (Approx)\",\n      \"description\": \"If budget allows stretching slightly, this offers clean, modern, no-frills rooms in a prime location near Connaught Place and Janpath Metro Station. Excellent connectivity.\"\n    }\n  ],\n  \"dailyItinerary\": [\n    {\n      \"day\": 1,\n      \"theme\": \"Old Delhi Exploration & History\",\n      \"plan\": [\n        {\n          \"placeName\": \"Jama Masjid\",\n          \"placeDetails\": \"One of India's largest mosques, built by Shah Jahan. Explore its vast courtyard and intricate architecture. Dress modestly (cover shoulders, knees; head covering for women often required - scarves available for rent). Entry free, camera fee may apply.\",\n          \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Jama_Masjid%2C_Delhi_-panoramio%282%29.jpg/1200px-Jama_Masjid%2C_Delhi_-panoramio%282%29.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 28.6507,\n            \"longitude\": 77.2334\n          },\n          \"ticketPricingRating\": \"Free (Camera fee extra)\",\n          \"timeToSpend\": \"1 - 1.5 Hours\",\n          \"travelNotes\": \"Take Metro to Jama Masjid (Violet Line) or Chawri Bazar (Yellow Line) and walk/e-rickshaw.\"\n        },\n        {\n          \"placeName\": \"Chandni Chowk\",\n          \"placeDetails\": \"Explore the chaotic and vibrant lanes of Old Delhi's main street. Experience the sounds, smells, and sights. Consider a cycle rickshaw ride (negotiate price beforehand ~₹100-200). Great for budget street food (Paranthe Wali Gali, Jalebi).\",\n          \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/1/18/Chandni_Chowk_market%2C_Delhi.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 28.656,\n            \"longitude\": 77.231\n          },\n          \"ticketPricingRating\": \"Free (Shopping/Food extra)\",\n          \"timeToSpend\": \"2 - 3 Hours (Including Lunch)\",\n          \"travelNotes\": \"Walk from Jama Masjid or take a short cycle rickshaw ride.\"\n        },\n        {\n          \"placeName\": \"Red Fort (Lal Qila) - Exterior View & Walk\",\n          \"placeDetails\": \"Iconic Mughal fort. To save money, admire the impressive red sandstone walls from the outside and walk around the perimeter. Entry fee applies if you wish to go inside.\",\n          \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Delhi_fort.jpg/1200px-Delhi_fort.jpg\",\n          \"geoCoordinates\": {\n            \"latitude\": 28.6561,\n            \"longitude\": 77.2410\n          },\n          \"ticketPricingRating\": \"Free (Exterior) / Medium (Interior)\",\n          \"timeToSpend\": \"0.5 - 1 Hour (Exterior View)\",\n          \"travelNotes\": \"Short walk/e-rickshaw from Chandni Chowk area.\"\n        },\n        {\n          \"placeName\": \"Raj Ghat\",\n          \"placeDetails\": \"Memorial dedicated to Mahatma Gandhi, located on the banks of the Yamuna River. A serene and reflective place. Entry is free. Remove footwear before entering the memorial area.\",\n          \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Raj_Ghat_-Mahatma_Gandhi_Memorial-New_Delhi-India_01.JPG/1280px-Raj_Ghat-Mahatma_Gandhi_Memorial-New_Delhi-_India_01.JPG\",\n          \"geoCoordinates\": {\n            \"latitude\": 28.6406,\n            \"longitude\": 77.2495\n          },\n          \"ticketPricingRating\": \"Free\",\n          \"timeToSpend\": \"1 Hour\",\n          \"travelNotes\": \"Take an auto-rickshaw/e-rickshaw from Red Fort area (~10-15 mins).\"\n        }\n      ]\n    },\n    {\n      \"day\": 2,\n      \"theme\": \"New Delhi Monuments & Green Spaces\",\n      \"plan\": [\n        {\n          \"placeName\": \"Humayun's Tomb\",\n          \"placeDetails\": \"Magnificent tomb of Mughal Emperor Humayun, a precursor to the Taj Mahal. Beautiful gardens and architecture. A UNESCO World Heritage site.\",\n          \"placeImageUrl\": \"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Humayun%27s_Tomb%2C_Delhi%2C_India_05.JPG/1280px-Humayun%27s_Tomb%2C_Delhi%2C_India_05.JPG\",\n          \"geoCoordinates\": {\n            \"latitude\": 28.5933,\n            \"longitude\": 77.2507\n          },\n          \"ticketPricingRating\": \"Medium\",\n          \"timeToSpend\": \"1.5 - 2 Hours\",\n          \"travelNotes\": \"Take Metro to Jor Bagh (Yellow Line) or JLN Stadium (Violet Line) and then an auto-rickshaw.\"\n        },\n        {\n          \"place"},
          ],
        },
      ],
    });